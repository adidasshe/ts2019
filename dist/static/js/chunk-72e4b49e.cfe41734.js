(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72e4b49e"],{"047c":function(t,o,e){"use strict";var n=e("e3c1"),a=e.n(n);a.a},"114c":function(t,o){!function(t,o,e){"use strict";t.L.Toolbar2=(L.Layer||L.Class).extend({statics:{baseClass:"leaflet-toolbar"},options:{className:"",filter:function(){return!0},actions:[]},initialize:function(t){L.setOptions(this,t),this._toolbar_type=this.constructor._toolbar_class_id},addTo:function(t){return this._arguments=[].slice.call(arguments),t.addLayer(this),this},onAdd:function(t){var o=t._toolbars[this._toolbar_type];0===this._calculateDepth()&&(o&&t.removeLayer(o),t._toolbars[this._toolbar_type]=this)},onRemove:function(t){0===this._calculateDepth()&&delete t._toolbars[this._toolbar_type]},appendToContainer:function(t){var o,e,n,a,i=this.constructor.baseClass+"-"+this._calculateDepth()+" "+this.options.className;for(this._container=t,this._ul=L.DomUtil.create("ul",i,t),this._disabledEvents=["click","mousemove","dblclick","mousedown","mouseup","touchstart"],e=0,a=this._disabledEvents.length;e<a;e++)L.DomEvent.on(this._ul,this._disabledEvents[e],L.DomEvent.stopPropagation);for(o=0,n=this.options.actions.length;o<n;o++)(new(this._getActionConstructor(this.options.actions[o])))._createIcon(this,this._ul,this._arguments)},_getActionConstructor:function(t){var o=this._arguments,e=this;return t.extend({initialize:function(){t.prototype.initialize.apply(this,o)},enable:function(o){e._active&&e._active.disable(),e._active=this,t.prototype.enable.call(this,o)}})},_hide:function(){this._ul.style.display="none"},_show:function(){this._ul.style.display="block"},_calculateDepth:function(){for(var t=0,o=this.parentToolbar;o;)t+=1,o=o.parentToolbar;return t}}),L.Evented||L.Toolbar2.include(L.Mixin.Events),L.toolbar={};var n=0;L.Toolbar2.extend=function(t){var o=L.extend({},t.statics,{_toolbar_class_id:n});return n+=1,L.extend(t,{statics:o}),L.Class.extend.call(this,t)},L.Map.addInitHook((function(){this._toolbars={}})),L.Toolbar2.Action=L.Handler.extend({statics:{baseClass:"leaflet-toolbar-icon"},options:{toolbarIcon:{html:"",className:"",tooltip:""},subToolbar:new L.Toolbar2},initialize:function(t){var o=L.Toolbar2.Action.prototype.options.toolbarIcon;L.setOptions(this,t),this.options.toolbarIcon=L.extend({},o,this.options.toolbarIcon)},enable:function(t){t&&L.DomEvent.preventDefault(t),this._enabled||(this._enabled=!0,this.addHooks&&this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks&&this.removeHooks())},_createIcon:function(t,o,e){var n=this.options.toolbarIcon;this.toolbar=t,this._icon=L.DomUtil.create("li","",o),this._link=L.DomUtil.create("a","",this._icon),this._link.innerHTML=n.html,this._link.setAttribute("href","#"),this._link.setAttribute("title",n.tooltip),L.DomUtil.addClass(this._link,this.constructor.baseClass),n.className&&L.DomUtil.addClass(this._link,n.className),L.DomEvent.on(this._link,"click",this.enable,this),this._addSubToolbar(t,this._icon,e)},_addSubToolbar:function(t,o,e){var n=this.options.subToolbar,a=this.addHooks,i=this.removeHooks;n.parentToolbar=t,n.options.actions.length>0&&((e=[].slice.call(e)).push(this),n.addTo.apply(n,e),n.appendToContainer(o),this.addHooks=function(t){"function"==typeof a&&a.call(this,t),n._show()},this.removeHooks=function(t){"function"==typeof i&&i.call(this,t),n._hide()})}}),L.toolbarAction=function(t){return new L.Toolbar2.Action(t)},L.Toolbar2.Action.extendOptions=function(t){return this.extend({options:t})},L.Toolbar2.Control=L.Toolbar2.extend({statics:{baseClass:"leaflet-control-toolbar "+L.Toolbar2.baseClass},initialize:function(t){L.Toolbar2.prototype.initialize.call(this,t),this._control=new L.Control.Toolbar(this.options)},onAdd:function(t){this._control.addTo(t),L.Toolbar2.prototype.onAdd.call(this,t),this.appendToContainer(this._control.getContainer())},onRemove:function(t){L.Toolbar2.prototype.onRemove.call(this,t),this._control.remove?this._control.remove():this._control.removeFrom(t)}}),L.Control.Toolbar=L.Control.extend({onAdd:function(){return L.DomUtil.create("div","")}}),L.toolbar.control=function(t){return new L.Toolbar2.Control(t)},L.Toolbar2.Popup=L.Toolbar2.extend({statics:{baseClass:"leaflet-popup-toolbar "+L.Toolbar2.baseClass},options:{anchor:[0,0]},initialize:function(t,o){L.Toolbar2.prototype.initialize.call(this,o),this._marker=new L.Marker(t,{icon:new L.DivIcon({className:this.options.className,iconAnchor:[0,0]})})},onAdd:function(t){this._map=t,this._marker.addTo(t),L.Toolbar2.prototype.onAdd.call(this,t),this.appendToContainer(this._marker._icon),this._setStyles()},onRemove:function(t){t.removeLayer(this._marker),L.Toolbar2.prototype.onRemove.call(this,t),delete this._map},setLatLng:function(t){return this._marker.setLatLng(t),this},_setStyles:function(){for(var t,o,e,n=this._container,a=this._ul,i=L.point(this.options.anchor),s=a.querySelectorAll(".leaflet-toolbar-icon"),l=[],r=0,c=0,p=s.length;c<p;c++)s[c].parentNode.parentNode===a&&(l.push(parseInt(L.DomUtil.getStyle(s[c],"height"),10)),r+=Math.ceil(parseFloat(L.DomUtil.getStyle(s[c],"width"))),r+=Math.ceil(parseFloat(L.DomUtil.getStyle(s[c],"border-right-width"))));a.style.width=r+"px",this._tipContainer=L.DomUtil.create("div","leaflet-toolbar-tip-container",n),this._tipContainer.style.width=r+Math.ceil(parseFloat(L.DomUtil.getStyle(a,"border-left-width")))+"px",this._tip=L.DomUtil.create("div","leaflet-toolbar-tip",this._tipContainer),t=Math.max.apply(void 0,l),a.style.height=t+"px",o=parseInt(L.DomUtil.getStyle(this._tip,"width"),10),e=new L.Point(r/2,t+1.414*o),n.style.marginLeft=i.x-e.x+"px",n.style.marginTop=i.y-e.y+"px"}}),L.toolbar.popup=function(t){return new L.Toolbar2.Popup(t)}}(window,document)},"575a":function(t,o,e){"use strict";e.r(o);var n=function(){var t=this,o=t.$createElement;t._self._c;return t._m(0)},a=[function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("pre",{attrs:{id:"info"}}),t._v(" "),e("div",{attrs:{id:"map"}})])}],i=e("db72"),s=(e("7f7f"),e("b199"),e("2f62")),l=e("e11eb"),r=e.n(l),c=(e("6cc5"),e("114c"),e("ed6f"),{data:function(){return{loadPointStatus:0,polygonStatus:0,pointStatus:0,status:0,layersPoint:[],loadPoint:[],temp:{task_name:"",carnums:"",model:"",dest:[],username:"",maxLon:"",maxLat:"",minLon:"",minLat:"",source:"",target:""},mapUrl:"http://openstreetmap/osm_tiles/{z}/{x}/{y}.png"}},mounted:function(){this.temp.task_name=this.task_name,this.temp.username=this.name,this.temp.carnums=this.carnums,this.init()},computed:Object(i["a"])({},Object(s["b"])(["name","task_name","carnums"])),methods:{init:function(){var t=this,o=r.a.map("map").setView([31.2210226,121.489219],13);r.a.tileLayer(this.mapUrl,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(o);var e,n,a,i,s=this,l=function(){for(var t=0;t<s.layersPoint.length;t++)s.layersPoint[t].remove();s.temp.dest.length=0,s.pointStatus=0,s.status=0},c=function(){"undefined"!=typeof n&&n.remove(),"undefined"!=typeof e&&e.remove(),s.temp.maxLon="",s.temp.maxLat="",s.temp.minLon="",s.temp.minLat="",s.polygonStatus=0},p=function(){for(var t=0;t<s.loadPoint.length;t++)s.loadPoint[t].remove();s.temp.source="",s.temp.target="",s.loadPointStatus=0},u=function(){if(1===s.loadPointStatus)s.$message.error("道路已经选择，请点击重选");else{var a=[];s.$message({message:"请在地图上选择区域",type:"warning"}),o.on("click",(function(e){"undefined"!=typeof n&&n.remove(),a[0]=[e.latlng.lat,e.latlng.lng],t.temp.maxLon=e.latlng.lng,t.temp.maxLat=e.latlng.lat,o.on("mousemove",(function(t){o.off("click"),a[1]=[t.latlng.lat,t.latlng.lng],"undefined"!=typeof n&&n.remove(),n=r.a.rectangle(a,{dashArray:5}).addTo(o)}))})),o.on("dblclick",(function(n){if(o.off("mousemove"),a[1]=[n.latlng.lat,n.latlng.lng],t.temp.minLon=n.latlng.lng,t.temp.minLat=n.latlng.lat,e=r.a.rectangle(a,{color:"#3300ff",fillOpacity:0,weight:2}).addTo(o),o.off("dblclick"),s.polygonStatus=1,s.temp.minLat>s.temp.maxLat){var i=s.temp.maxLon;s.temp.maxLon=s.temp.minLon;var l=s.temp.maxLat;s.temp.maxLat=s.temp.minLat,s.temp.minLon=i,s.temp.minLat=l}o.fitBounds(a)}))}},m=function(){0===s.polygonStatus&&0===s.loadPointStatus?s.$message.error("请先选择区域或者道路"):0!=s.pointStatus?s.$message.error("疏散点已选择"):(s.$message({message:"请在选择的疏散区域外选择疏散点",type:"warning"}),o.on("click",(function(t){s.temp.minLat<=t.latlng.lat&&t.latlng.lat<=s.temp.maxLat&&s.temp.maxLon<=t.latlng.lng&&t.latlng.lng<=s.temp.minLon?s.$message.error("请在区域外选择疏散点"):0===s.polygonStatus&&0===s.loadPointStatus?o.off("click"):(a=r.a.circle(t.latlng,{radius:10,color:"red",fillColor:"red",fillOpacity:1}).addTo(o),s.layersPoint.push(a),s.temp.dest[s.status]=[t.latlng.lat,t.latlng.lng],s.$message({message:"疏散点 ".concat(s.status+1," :").concat(t.latlng),type:"success"}),s.status+=1,o.on("dblclick",(function(t){o.off("click"),o.off("dblclick"),s.pointStatus=1})))})))},h=function(){1===s.polygonStatus?s.$message.error("区域已选择，请点击重选"):1===s.loadPointStatus?s.$message.error("道路已选择"):(l(),s.$message({message:"请在地图中选择道路",type:"warning"}),o.on("click",(function(t){""==s.temp.source?(i=r.a.circle(t.latlng,{radius:10,color:"blue",fillColor:"blue",fillOpacity:1}).addTo(o),s.loadPoint.push(i),s.temp.source=[t.latlng.lat,t.latlng.lng]):(i=r.a.circle(t.latlng,{radius:10,color:"blue",fillColor:"blue",fillOpacity:1}).addTo(o),s.loadPoint.push(i),s.temp.target=[t.latlng.lat,t.latlng.lng],s.loadPointStatus=1,o.off("click"))})))},d=r.a.Toolbar2.Action.extend({options:{toolbarIcon:{html:"地点",className:"ss",tooltip:"选择疏散点"}},addHooks:function(){m()}}),f=r.a.Toolbar2.Action.extend({options:{toolbarIcon:{html:"区域",className:"ss",tooltip:"选择疏散区域"}},addHooks:function(){0===s.polygonStatus?(l(),u()):s.$message.error("区域已选择")}}),b=r.a.Toolbar2.Action.extend({options:{toolbarIcon:{html:"确定",className:"ss",tooltip:"坐标选取完毕，返回任务创建"}},addHooks:function(){s.toCreat()}}),L=r.a.Toolbar2.Action.extend({options:{toolbarIcon:{html:"重选",className:"ss",tooltip:"清除选择区域、道路及疏散点"}},addHooks:function(){l(),c(),p()}}),g=r.a.Toolbar2.Action.extend({options:{toolbarIcon:{html:"道路",className:"ss",tooltip:"选择单条疏散道路"}},addHooks:function(){h()}});new r.a.Toolbar2.Control({position:"topleft",actions:[f,g,d,L,b]}).addTo(o)},toCreat:function(){0!=this.polygonStatus&&0!=this.status||0!=this.loadPointStatus&&0!=this.status?(this.$store.state.task.creat_temp=this.temp,this.$store.state.task.dialogFormVisible=!0,this.$router.push({name:"task"})):this.$message.error("区域或疏散点未选择！！！")}}}),p=c,u=(e("047c"),e("2877")),m=Object(u["a"])(p,n,a,!1,null,null,null);o["default"]=m.exports},"6cc5":function(t,o,e){},e3c1:function(t,o,e){},ed6f:function(t,o,e){}}]);